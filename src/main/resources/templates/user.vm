<div id="speakeasyUserMain">
    <a style="display:none" id="bespin_base" href="$staticResourcesPrefix/download/resources/com.atlassian.labs.speakeasy-plugin:bespin/">asdfasfd</a>
<script type="text/javascript">
        var staticResourcesPrefix = "$staticResourcesPrefix";
        var contextPath = "$contextPath";
        var plugins = $plugins.renderJson;
        var currentUser = "$user";
        var product = "$product";
    </script>

    <script type="text/x-template" title="download-dialog">
        <p>
            This will create an AMPS project for the extension '{pluginKey}'.
            To use it:
        </p>
        <ol>
            <li>Unzip the file into an empty directory</li>
            <li>Start the target product with the extension installed by running:
<pre>
mvn {product}:run
</pre></li>
            <li>Edit the extension files, usually in <code>src/main/resources</code>, and refresh your browser
            to see the changes.</li>
        </ol>
        <a id="downloadLink" href="{href}">Download</a>
    </script>

    <script type="text/x-template" title="ide-dialog">
        <div id="ide-content">
            {firstScript}
            <div id="ide-file-contents-panel">
                <b>Extension Contents</b>
                <ul id="ide-browser" class="filetree">
                </ul>
            </div>
            <div id="ide-main-content">
                <div id="ide-editor"></div>
            </div>
            {secondScript}
        </div>
    </script>

    <script type="text/x-template" title="owner-actions">
        <a class="pk_uninstall" href="$contextPath/rest/speakeasy/1/plugins/{key}">Uninstall</a>

        <a class="pk_edit" href="$contextPath/rest/speakeasy/1/plugins/{key}/index">Edit</a>
    </script>

    <script type="text/x-template" title="non-fork-actions">
        <a class="pk_fork" href="$contextPath/rest/speakeasy/1/plugins/fork/{key}">Fork</a>
    </script>

    <script type="text/x-template" title="browser-leaf">
        <li><span class="{class}">{text}</span>{children}</li>
    </script>

    <script type="text/x-template" title="row">
        <tr data-pluginKey="{key}">
            <td headers="pluginName">{name}</td>
            <td headers="pluginDescription">{description}</td>
            <td headers="pluginAuthor">{author}</td>
            <td headers="pluginVersion">{version}</td>
            <td headers="pluginUsers">{numUsers}</td>
            <td headers="action">
                <a class="pk_enable_toggle" href="$contextPath/rest/speakeasy/1/user/{key}">{enableText}</a>
                <a class="pk_download" href="javascript:void(0)" data-download="$contextPath/rest/speakeasy/1/plugins/download/{key}.zip">Download</a>
                {ownerActions}
                {nonForkActions}
            </td>
        </tr>
    </script>
<div id="aui-message-bar"> </div>

<h2>Installed Extensions</h2>
<table class="aui" id="pluginsTable">
<thead>
    <tr>
        <th id="pluginName">Name</th>
        <th id="pluginDescription">Description</th>
        <th id="pluginAuthor">Author</th>
        <th id="pluginVersion">Version</th>
        <th id="pluginUsers">Users</th>
        <th id="action">Action</th>
    </tr>
</thead>
<tbody id="pluginsTableBody">

</tbody>
</table>


#if ($devmode && $installAllowed)
    <div style="background-color: #f0f0f0; margin: 20px; padding: 10px; border: 1px solid #bbb;">
        <form id="uploadForm" action="$contextPath/rest/speakeasy/1/plugins" enctype="multipart/form-data" method="post">
            <b>Upload New Extension:</b>
            <label for="pluginFile">Install a new extension by uploading from your computer:</label> <input id="pluginFile" type="file" name="pluginFile" size="40">
        </form>
    </div>
#end

<script type="text/javascript">
        initSpeakeasy();
</script>
</div>
